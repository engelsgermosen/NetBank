@{

}

@using NetBank.Core.Application.ViewModels.Product;
@using NetBank.Core.Domain.Enums
@model List<ProductViewModel>



<div class="container-fluid">
    <div class="row">

        @if (!string.IsNullOrWhiteSpace(ViewBag.Message))
        {
            <div class="col-10 col-md-5 mx-auto alert text-dark @ViewBag.MessageType" role="alert">
                @ViewBag.Message
            </div>
        }
        <div class="col-12 col-md-10 mx-auto mt-4">
            <div class="row">
                <div class="col-12">
                    <a asp-action="Create" asp-controller="Product" asp-route-userId="@Model?.FirstOrDefault()?.UserId" class="btn btn-primary float-end">Agregar producto</a>
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-12">
                    
                    @if(Model?.Count > 0 && Model != null)
                    {

                        @foreach(var i in Model)
                        {
                            switch(i.ProductType)
                            {
                                case ProductType.CuentaAhorro:
                                    <div class="card col-4">
                                        <div class="card-header">
                                            <h4>@i.ProductType</h4>
                                            <span class="@(i.IsMain ? "bg-success text-white p-2":"")">@(i.IsMain ? "Principal":"")</span>
                                        </div>
                                        <div class="card-body">
                                            <p>@i.Balance</p>
                                            @if(!i.IsMain)
                                            {
                                                <a asp-route-id="@i.AccountNumber" asp-route-userId="@i.UserId" asp-route-productType="@i.ProductType" asp-action="Delete" asp-controller="Product" class="btn btn-danger">Delete</a>
                                            }
                                        </div>
                                    </div>
                                    break;
                                case ProductType.CreditCard:
                                    <div class="card col-4">
                                        <div class="card-header">
                                            <h4>@i.ProductType</h4>
                                        </div>
                                        <div class="card-body">
                                            <p>@i.CreditLimit</p>
                                            <span>Debe: @(i.AmountOwed ?? 0)</span>
                                            <a asp-route-id="@i.AccountNumber" asp-route-userId="@i.UserId" asp-route-productType="@i.ProductType" asp-action="Delete" asp-controller="Product" class="btn btn-danger">Delete</a>
                                        </div>
                                    </div>
                                    break;
                                case ProductType.Prestamo:
                                    <div class="card col-4">
                                        <div class="card-header">
                                            <h4>@i.ProductType</h4>
                                        </div>
                                        <div class="card-body">
                                            <p>Monto adeudado: @(i.AmountOwed ?? 0)</p>
                                            <a asp-route-id="@i.AccountNumber" asp-route-userId="@i.UserId" asp-route-productType="@i.ProductType" asp-action="Delete" asp-controller="Product" class="btn btn-danger">Delete</a>
                                        </div>
                                    </div>
                                    break;
                            }
                            
                        }
                    }
                </div>
            </div>

        </div>
    </div>
</div>